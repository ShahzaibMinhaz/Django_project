<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <form action="" method="POST" class="mb-3 mt-4 container">
        {% csrf_token %}
        {{ form }}
        <input type="Submit" value="Submit" class="submit">
    </form>
    <table class="table container w-75">
        <thead>
          <tr>
            <th scope="col">Item Name</th>
            <th scope="col">Item quentity</th>
            <th scope="col">Item Price</th>
            <th scope="col">Total Price</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
      <div class="input-group w-25 float-right mt-5 container mr-5">
        <div class="input-group-prepend">
          <span class="input-group-text" id="basic-addon1">Total Price</span>
        </div>
        <input type="text" disabled class="form-control TotalPrice" placeholder="Total" aria-label="Username" aria-describedby="basic-addon1">
        <input type="button" class="btn btn-success mt-3 SubmitInvoice" value="Submit Invoice Data">
      </div>
     


<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<script type="text/javascript">

    // initialize total price variable 
    Total_price = 0

    // submit button 
    $(document ).ready(function() {

        // Submit data to row button    
        $('.submit').click(function(e){
            e.preventDefault();

            // getting values from input field
            name = $('#item_name').val()
            quantity = $('#item_quantity').val()
            price = $('#item_price').val()

            //calculating total
            ItemTotal_Price = quantity*price
            Total_price = Total_price + ItemTotal_Price
            // Update  total price 


            //appending data to table
            $('.table').append('<tr><td scope="row">'+name+'</td><td>'+quantity+'</td><td>'+price+'</td><td>'+ItemTotal_Price+'</td><td><input id="delbtn type="button" value="DELETE" class="btn btn-danger"/></td></tr>');
           
            // setting input 
            $('#item_name').val('')
            $('#item_quantity').val('')
            $('#item_price').val('')
            $('.TotalPrice').val(Total_price)

        });

        // delete row with row button 
        $(document).on('click', '.btn-danger', function() {
            // get delete item total price 
            var price = $(this).closest("tr").find('td:nth-child(4)').text();

            // update total price 
            Total_price = Total_price - price
            console.log(Total_price)

            // set total price 
            $('.TotalPrice').val(Total_price)
             
            // remove tr from table 
            $(this).parent().parent('tr').remove();
        });

        // Submit Invoice Data button 
        $('.SubmitInvoice').click(function(e){
            e.preventDefault()
            alert('Submit Invoice')

            // get all data of table in array ary
            var ary = [];
            var table = $(".table");
            table.find('tr').each(function (i, el) {
                if(i!=0){ 
                    console.log(i+''+el)
                    var $tds = $(this).find('td'),
                    productName = $tds.eq(0).text(),
                    productQuantity = $tds.eq(1).text(),
                    productPrice = $tds.eq(2).text();
                    ary.push({ productName: productName, productQuantity: productQuantity,productPrice:productPrice });
                }
            });
            console.log(ary)
            table.children('tbody').children('tr').remove();
        });

    });
</script>
</body>
</html>